# -*- coding: utf-8 -*-from openpyxl import Workbookfrom openpyxl.styles import Alignment# 不同表通过修改这里excelName = "仙萌战纪" #表格名称titleList = ['商品名称','商品ID','金额','对应元宝','商品信息'] #表头bundleID = "com.godmzj.xm.rmb"priceList = [6,30,68,128,198,328,488,648] #价格unitStr = '元宝' #游戏内单位# 通过查找关键字descriptionStr = '立马充值，即刻获得元宝'keyword = "即刻获得"# 如果是输入类型workbook = Workbook()booksheet = workbook.active     #获取当前活跃的sheet,默认是第一个sheet# 填写表格booksheet.append(titleList)for price in priceList:    lineList = [str(price * 10) + unitStr,                bundleID + str(price),                price,                str(price * 10) + unitStr,                descriptionStr.replace(keyword, keyword + str(price * 10))]    booksheet.append(lineList)# column 竖行 row横行max_row = len(priceList) + 1max_col = len(titleList)# 设置自适应宽度for column_index in range(1,max_col + 1):   maxWidth = 0   for row_index in range(1,max_row + 1) :       value = booksheet.cell(row = row_index, column= column_index).value       if isinstance(value, int):           value = str(value) #将中间int类型改变       chineseNum = (len(value.encode('utf-8')) - len(value))/2       width = len(value.encode('utf-8')) - chineseNum + 4  # +4 留下多余空间       if width > maxWidth:           maxWidth = width   codeAsc = ord(str(column_index)) + 16   booksheet.column_dimensions[chr(codeAsc)].width = maxWidth   # 这边要留着一个最大值#  居中显示for meta_cell in booksheet:    for cell in meta_cell:        cell.alignment = Alignment(horizontal='center')workbook.save(excelName + ".xlsx")